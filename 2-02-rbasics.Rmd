## データの可視化
　前節では基本的な要約統計量と**R**を使った求め方を紹介しました。本節ではデータの特徴を視覚的に把握するために使われるグラフの描画方法を紹介します。  
　対象となるデータはフィッシャーのあやめ（`iris`データセット）で、前出のように4つの数値型（実数型）ベクトルと1つの因子型ベクトルから成り立っているデータです。このようなデータ形式を**R**ではデータフレーム型と呼びます。データフレーム型はすべてのベクトルの長さ（行数）が同じでなければなりません。また、行方向単位で一組のデータになります。データフレーム型のデータはデータセットと呼ばれます。  
　全データを表示すると冗長ですので`head()`関数を用いて先頭から10行を表示します。  
　

```{r}
head(x = iris, n = 10L)
```
　`head()`関数は引数`n`を省略した場合、`x`で指定したデータの先頭から6行（6個）の値を表示する関数です。`x =`や`n =`といった引数名の表記は省略可能です。詳細は`?head()`でヘルプを表示して確認してください。


### ヒストグラム
　ヒストグラム（histgram）は量的データの分布を見る際に利用するグラフです。横軸にデータが取る範囲（階級）を縦軸に階級に含まれるデータの個数（度数）をとります。度数分布図と呼ばれることもあります。ヒストグラムを描くには、まず、度数の分布表を作成する必要があります。  
　度数分布表を作成するには、最初に階級を決める必要があります。階級の決め方は任意なのできりの良い数値を使うことが多いですが、以下のような計算方法も提案されています。

\newpage

: 階級数の計算方法

計算方法          | 説明
------------------|------------------------------------------------------------
Squre-root choice | データ`x`の数（`n`）の平方根を用いる方法
Sturges’s formula | データ`x`の数（`n`）が、$n \ge 30$を満たす場合に使える方法
Scott's choice    | データ`x`の標準偏差を用いる方法
Freedman-Diaconis choice | データ`x`の四分位範囲に基づく方法


　**R**では、度数分布表を作成せずもとヒストグラムを描くことが可能です。ヒストグラムを描くには`hist()`関数を用います。ヒストグラムは単一データの可視化に用いるものですがから、`iris`データセットにある量的データから任意の１データを指定しなければなりません。

```{r}
hist(x = iris$Sepal.Width)
```

　`$`はデータフレームから任意の列のデータを取り出す演算子です。`hist()`関数はデーフォルトではSturges's formulaを用いて階級幅を決めています。`pretty()`関数に求めた階級数を指定することで単なる割り算ではない適切な階級幅を求めることができます。
　
```{r}
pretty(x = iris$Sepal.Width, n = nclass.Sturges(iris$Sepal.Width))
```

\newpage

　この階級幅を元に度数分布表を作成すると下表のようになります。

```{r, echo=FALSE}
breaks <- pretty(x = iris$Sepal.Width, n = nclass.Sturges(iris$Sepal.Width))

iris %>% 
  dplyr::mutate(freq = cut(Sepal.Width, breaks, include.lowest = TRUE)) %>% 
  dplyr::count(freq) %>% 
  dplyr::mutate(cum = cumsum(n)) %>% 
  dplyr::rename(`階級` = freq, `度数` = n, `累積度数` = cum) %>% 
  df_print(all = TRUE, caption = "Sepal.Widthの度数分布表")
```




### 散布図

```{r}
iris %>% 
  dplyr::select(where(is.numeric)) %>% 
  purrr::map_df(fivenum)

iris %>% 
  dplyr::select(where(is.numeric)) %>% 
  purrr::map_df(quantile)
```



### 箱ひげ図
　箱ひげ図（boxplot）は、五数要約と呼ばれる要約統計量を可視化するグラフです。五数要約は前節で説明した最小値、第一四分位数、中央値（第二四分位数）、第三四分位数、最大値の5つを意味し`fivenum()`関数を使って求められます。四分位数を求める`quantile()`関数とは異なります。  


　`iris`データセットの五数要約は下記のようになります。

```{r}
apply(X = iris[-5], MARGIN = 2, FUN = fivenum)
```

　ここで`iris[-5]`は5列目を除いた4列を取り出すことを意味します。`apply()`関数は演習解答例でも記載していますように繰り返し処理（任意の関数を繰り返して適用する）を行う関数で、`X`で指定した変数に対して列方向（`MARGIN = 2`）に`FUN`で指定した関数を適用します。  
　五数要約を可視化するには`boxplot()`関数を使います。

```{r, fig.cap="箱ひげ図"}
boxplot(iris[-5])
```

　箱ひげ図は、その名の通り箱（長方形）とひげ（線）からなるグラフです。箱の下辺と上辺が第一四分位数と第三四分位数、箱の中の線が中央値（第二四分位数）を上下のひげが最小値と最大値を表しています。ただし、`boxplot()`関数で描く箱ひげ図で注意しなければならない点は、**外れ値（Outliers）**を考慮している点にあります。外れ値とは四分位範囲（第一四分数から第三四分位までの範囲）の**1.5倍**の範囲を超える値を意味しています。




## 推定
　前節で扱った要約統計量は与えられたデータに関する特徴を求めるもので一般的には**記述統計**と呼ばれる手法に分類されます。前節には不偏推定量の記述もありますが、こちらは確率変数と確率分布の確率論をベースとした**推測統計**と呼ばれる手法に分類されます。推測統計は大きく統計的推定と統計的仮説検定に二分されます。本節は統計的**推定**の話です。


### 母集団と標本
　母集団とは分析の結果をもって説明したいデータの全体集合です。母集団の全てのデータを調べることができれば前述の記述統計の手法を適用することができますが、大抵の場合、母集団はとてつもなく大きな集団であったり、全数調査が困難[^31]だったりします。
そこで、標本と呼ばれる母集団から抽出した部分集合のデータが示す特徴を用いて母集団の特徴を推測することになります。しかしながら、標本のとり方よってはデータが偏ってしまい母集団の特徴からずれてしまう可能性がありす。そこで、確率論を用いて標本と母集団とのずれ（誤差の大きさ）を評価し信頼度つきで母集団の特徴を推測する推測統計の出番です。

[^31]: 例えばテレビの世帯視聴率のように全世帯のデータを集めるとコスト的に見合わないような調査


### 点推定
　点推定は標本から求められる一つの推定値をもって母集団の特徴となる統計量の推定値とする方法です。例えば、前節で出てきた不偏分散は、まさにこの点推定の結果です。不偏推定値と呼ばれることもあります。

母平均、母分散


### 区間推定
　一方、区間推定は文字通り幅を持たせて母集団の特徴となる統計量を推定する方法です。この幅を信頼区間（CI: Confidence Interval）と呼びます。

母平均、母比率、母分散


母平均の区間推定には大きく以下の二つの方法があります。

* 母分散が既知の場合
* 母分散が未知の場合

通常は




### まとめ


<!-- \newpage -->

### 演習
```{r, include=FALSE}
eqn <- eqn + 1
```

#### 演習 `r eqn` {.unnumbered}

```{r, include=FALSE}
eqn <- eqn + 1
```

#### 演習 `r eqn` {.unnumbered}

```{r, include=FALSE}
eqn <- eqn + 1
```

#### 演習 `r eqn` {.unnumbered}

