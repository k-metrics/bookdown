# Install
　R について学ぶ前に R が使えるように環境を整えます。本書は R, RStudio, [Tidyverse/ <i class="fa fa-external-link"></i>](https://www.tidyverse.org/){target="_blank"} パッケージならびに他のパッケージの利用を前提としています。
　R ならびに RStudio はマルチプラットフォーム対応ですので、プラットフォームは Windows, macOS, Linux のどのプラットフォームでも構いませんが、日本語版 Windows ではプラットフォームが使用している文字コードに起因する不具合（日本語が表示されないなど）が発生する可能性があります。  
　  
　環境を整えるための手順は以下のようになります。  

手順 | 実施内容                 | 備考
:---:|--------------------------|------ 
1    | Rのインストール          | 
2    | Rtoolsのインストール     | Winodwsのみ
3    | RStudioのインストール    | Desktop版
4    | パッケージのインストール | 
5    | Gitのインストール        | 

　  
　[Git <i class="fa fa-external-link"></i>](https://git-scm.com/){target="_blank"} は VCS(Version Control System) と呼ばれるソースの版管理を行うシステムです。必要な場合のみインストールしてください。

　  

## Install R
　R は [CRAN (The Comprehensive R Archive Network)<i class="fa fa-external-link"></i>](https://cran.r-project.org/){target="_blank"} と呼ばれる公式リポジトリから入手してインストールします。  
　  

### Windows
　Winodws では特段の理由がない限り [CRAN <i class="fa fa-external-link"></i>](https://cran.r-project.org/bin/windows/){target="_blank"} から最新バージョンをインストールしてください。  
　  

#### Rtools
　Windows ではコンパイラなどの開発ツール類が標準装備されていませんので R のパッケージをインストールする際に必要となるツールキットを別途インストールしておく必要があります。 [Rtools <i class="fa fa-external-link"></i>](https://cran.r-project.org/bin/windows/){target="_blank"} からインストールした R のバージョン用の Rtools をダウンロードしてインストールしてください。  
　  

### macOS (OS X)
　macOS ではインストールできるバージョンが限られていますので [CRAN <i class="fa fa-external-link"></i>](https://cran.r-project.org/bin/macosx/){target="_blank"} で確認の上、インストールしてください。  
　  

### Linux
　R がサポートしているディストリビューションは Debian, RedHat, Suse, Ubuntu のみです。Fedora を利用したい場合には [README <i class="fa fa-external-link"></i>](https://cran.r-project.org/bin/linux/redhat/README){target="_blank" title=""} を参照の上でRedHat Software のリポジトリからインストールしてください。  
　  
　Linux の場合、ディストリビューションごと・バージョンごとにインストール方法が異なりますので [CRAN <i class="fa fa-external-link"></i>](https://cran.r-project.org/bin/linux/){target="_blank"} を参考にインストールしてください。  


## Install RStudio Desktop
　R のインストールが完了したら統合開発環境（IDR）である RStudio Desktop をインストールします。 [Downloadページ <i class="fa fa-external-link"></i>](https://rstudio.com/products/rstudio/download/#download){target="_blank"} から使用している環境（OS）用の RStudio をダウンロードしてインストールしてください。 
　  

### 動作確認
　RStudio のインストールが完了したら RStudio を起動します。下図のようなウィンドウが立ち上がり左側の **Console** ペインに R のバージョンなどが表示されます。  
　  
![RStudio Desktop, Windows](./fig/RStudio_Desktop.png)

　**Console** ペインのプロンプト（`>`表示）の部分に`2 * 3`と打ち込んで［Enter］キーを押し`[1] 6`と表示されることを確認してください。

```{r, comment=""}
2 * 3
```

　  

## Install R packages
　次に必要となるいくつかのパッケージをインストールします。パッケージをインストールする場合はインターネットに接続されている必要があります。 **Console** ペインのプロンプトに以下のコードを入力し [Enter]キーを押して実行します。

```{r, eval=FALSE}
install.packages("tidyverse")
```

　インストールが終わりましたらパッケージが正しくインストールされていることを確認するために **Console** ペインに以下のコードを入力して実行します。
```{r, eval=FALSE}
library(tidyverse)
```

　以下のようなメッセージが表示されることを確認します。インストール時期によってはバージョン表記などが下記と異なる場合があります。なお、日本語版 Windows 環境では一部の文字が化けします。
```{r, eval=FALSE}
Loading required package: tidyverse
─ Attaching packages ─────────────────────────────── tidyverse 1.3.0 ─
✔ ggplot2 3.2.1     ✔ purrr   0.3.3
✔ tibble  2.1.3     ✔ dplyr   0.8.3
✔ tidyr   1.0.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.4.0
─ Conflicts ───────────────────────────────── tidyverse_conflicts() ─
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
```

　  

　続いて [rmarkdown <i class="fa fa-external-link"></i>](https://rmarkdown.rstudio.com/){target="_blank"} パッケージをインストールします。`tidyverse` パッケージのときと同様に以下のコードを **Console** ペインに入力して実行します。

```{r, eval=FALSE}
install.packages("rmarkdown")
```



## Install Git
　RStudio には版管理インタフェースが標準で用意されていますが、版管理システム（以降、VCS）自体は別途インストールする必要があります。RStudio で利用できる VCS は以下の二つです。 
　
* [Git <i class="fa fa-external-link"></i>](https://git-scm.com/){target="_blank"} 
* [Subversion(SVN) <i class="fa fa-external-link"></i>](https://subversion.apache.org/){target="_blank"}

　Git の方が [GitHub <i class="fa fa-external-link"></i>](https://github.com/){target="_blank"} などのクラウドサービスが充実していますので、これから版管理を利用する場合は Git の利用をおすゝめします。  
　  

### Git
　Windows および macOS は Gitの [ダウンロードページ <i class="fa fa-external-link"></i>](https://git-scm.com/downloads){target="_blank"} から最新バージョンをダウンロードしてインストールします。Linux はリポジトリからインストールするか [ダウンロードページ <i class="fa fa-external-link"></i>](https://git-scm.com/downloads){target="_blank"} から最新バージョンをダウンロードしてインストールしてください。  
　  

### Git Client
　RStudio には簡易的な Git のクライアント機能が標準で用意されていますが、きめ細かな操作を行いたい場合には Git の GUI クライアントをインストールしてください。

Git GUI Client           | Ubuntu | Mac | Windows | Memo
-------------------------|:---:|:---:|:---:|---------
[GitKraken <i class="fa fa-external-link"></i>](https://www.gitkraken.com/){target="_blank"}   | Yes | Yes | Yes | Free版は機能制限あり
[SmartGit <i class="fa fa-external-link"></i>](https://www.syntevo.com/smartgit/){target="_blank"}     | Yes | Yes | Yes | Free版でも機能制限なし^1^
[GitEye <i class="fa fa-external-link"></i>](https://www.collab.net/downloads/giteye){target="_blank"}         | Yes | Yes | Yes | 
[Sourcetree <i class="fa fa-external-link"></i>](https://www.sourcetreeapp.com/){target="_blank"} | No  | Yes | Yes | 日本語版あり
[GitHub Desktop <i class="fa fa-external-link"></i>](https://desktop.github.com/){target="_blank"} | No  | Yes | Yes | 

^1^ : 非商用利用の場合  


## RStudio Server
　R/Rstudio Desktop はマルチプラットフォーム対応ですがプラットフォーム（OS）ごとに以下のような制約があります。

* 日本語版 Windows 環境では文字コード変換が原因で日本語を正しく処理できないことが多い
* 18.04LTSより前の Ubuntu 環境では RStudio Desktop で日本語入力ができない
      * 有志による日本語入力パッチがリリースされている

　特に日本語版 Windows 環境はシフト JIS
（CP932） を使っているため日本語処理の問題は根本的な解決を期待できません。  
　  
　Web サーバベースで動作する RStudio Server を利用することで、このような日本語に関わる問題を一掃することができます。 [Docker <i class="fa fa-external-link"></i>](https://www.docker.com/){target="_blank"} のコンテナ技術を利用することで、Windows（要 Hyper-V または WSL2）・ macOS ・ Linux の各プラットフォームで統一された環境として動作させることが可能です。

