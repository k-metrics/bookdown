# 演習解答例

```{r, include=FALSE}
eqn <- 1
```

## 演習 `r eqn` {.unnumbered}
標本分散（$s^2$）と不偏分散（$\hat{\sigma}^2$）の関係式`r if (knitr::is_latex_output())'\\@ref(eq:variance)'`を用いて**R**で以下の二つのデータの標本分散を求めなさい。

```{r}
x <- c(1, 5, 5, 5, 9)
y <- c(1, 1, 5, 9, 9)
```


### 解答例 {.unnumbered}
```{r}
n <- length(x)
(n - 1) / n * var(x)
```

```{r}
n <- length(y)
(n - 1) / n * var(y)
```

参考までに不偏分散は以下の通りです。
```{r}
var(x)
var(y)
```


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}
欠損値を含む以下のデータの平均値（$\bar{x}$）、不偏分散（$\hat{\sigma}^2$）ならびに標本分散（$s^2$）を求めなさい。

```{r}
z <- c(1, 5, NA, 7, 9)
```

::: {.hint-box data-latex=""}
欠損値（`NA`）を含むデータを引数にする場合は、引数`na.rm`を指定します
:::

### 解答例 {.unnumbered}
```{r}
mean(z, na.rm = TRUE)
var(z, na.rm = TRUE)

variance <- function(x, na.rm = FALSE) {
  n <- sum(!is.na(x))
  return ((n - 1) / n * var(x, na.rm = na.rm))
}
variance(z, na.rm = TRUE)
```

\newpage

::: {.info-box data-latex="{Tips}"}
　`length()`関数は指定したデータの長さ（値の個数）を求める関数ですので、欠損値（`NA`）も値としてカウントします。`length()`関数に`na.rm`オプションはありません。
```{r}
z
length(z)
```

　そこで、値が`NA`か否かを調べる`is.na()`関数を用います。
```{r}
is.na(z)
```

　返り値は論理型（`TRUE`/`FALSE`）ですが、`TRUE`は$1$、`FALSE`は$0$と等価であることを利用し、否定演算子（`!`）と合計を求める`sum()`関数を組み合わせると`NA`を除くデータの長さを求めることができます。
```{r}
sum(!is.na(z))
```

　不偏分散を求める`var()`関数は`NA`が含まれるデータを指定する場合は、`na.rm`オプションを指定します。
```{r}
var(z)
var(z, na.rm = TRUE)
```

:::

\newpage

```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}
　`iris`データセットの各変量に対する四分位数を求めなさい。

### 解答例 {.unnumbered}
　`iris`データセットは**R**に標準で組み込まれているサンプルデータですので、`iris`と実行するだけでデータを表示することができますが、全てを表示すると長いのでここでは先頭の6行だけを`head()`関数を用いて表示します。

```{r}
head(iris)
```

　一番上の行は変量名（変数名）で、一番右側の`Species`は文字変量ですので、これを除いた四変量（`Sepal.Length`, `Sepal.Width`, `Petal.Length`, `Petal.Width`）に対して四分位数を求める`quantile()`関数を適用します。

```{r}
quantile(iris$Sepal.Length, probs = c(0.25, 0.50, 0.75))
quantile(iris$Sepal.Width, probs = c(0.25, 0.50, 0.75))
quantile(iris$Petal.Length, probs = c(0.25, 0.50, 0.75))
quantile(iris$Petal.Width, probs = c(0.25, 0.50, 0.75))
```

　`$`は参照演算子と呼ばれるデータセットの変量名を用いてデータを参照するための演算子です。


::: {.info-box data-latex="{Tips}"}
　解答例のように個々の変量毎に`quantile()`関数を適用するより`apply()`関数による繰り返し処理を用いた方が簡単です。`apply()`関数は`iris`データセットのような形式のデータに対して行方向（`MARGINE = 1`）、または、列方向（`MARGIN = 2`）に`FUN`オプションで指定する関数を適用します。`FUN`オプションの後ろには`FUN`オプションで指定した関数（この場合は`quantile()`関数）へ渡す引数を指定することができます。`iris`データセットは五列目の`Species`が文字変量ですので`iris[-5]`と指定することで取り除きます。

```{r}
apply(iris[-5], MARGIN = 2, FUN = quantile,
      probs = c(0.25, 0.50, 0.75))
```

　このように`apply()`関数は同じ処理を繰り返したい場合には非常に有用な関数です。憶えておいてください。
:::


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


```{r, include=FALSE}
eqn <- eqn + 1
```

## 演習 `r eqn` {.unnumbered}

### 解答例 {.unnumbered}


