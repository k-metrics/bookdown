[["index.html", "Rのすゝめ - Rによるデータ分析事始め - Preface", " Rのすゝめ - Rによるデータ分析事始め - Sampo Suzuki, CC 4.0 BY-NC-SA 2021-04-29 Preface ソフトウェア開発において「データに基づく品質管理」が必要と言われるようになってから久しくなりますが、様々な理由でデータに基づく管理を実践している組織はまだまだ少数派ではないでしょうか？しかし、世の中の流れは「データドリブン」というキーワードに代表されるようにデータを使いこなせる組織が優位に立てる時代、数学が利益を生み出す数理資本主義の時代と言われています。 『データ指向のソフトウェア品質マネジメント』 は、日本のソフトウェア品質管理におけるデータ管理の必要性とデータ分析に必要な知識を解説している数少ない書籍です。著者の一人である小池氏が主催している データ分析勉強会 では、メトリクス分析に興味をもつ有志がこれらの知識を元に統計的コンピューティングによる品質管理を実践するための様々な知識や手法を学んでいます。 本書は実務でメトリクス分析を行うソフトウェア品質技術者をはじめとし R を用いてデータ分析を行いたい方々を想定読者として R の基本的な知識を紹介しています。データ分析勉強会を通じて学んだ分析手法を実務で実践したい方の一助になれば幸いです。 本書は クリエイティブ・コモンズ 表示 - 非営利 - 継承 4.0 国際 ライセンス の下に提供されています。 あなたの従うべき条件は以下の通りです。 表示（BY） あなたは 適切なクレジットを表示し、ライセンスへのリンクを提供し、変更があったらその旨を示さなければなりません。これらは合理的であればどのような方法で行っても構いませんが、許諾者があなたやあなたの利用行為を支持していると示唆するような方法は除きます。 非営利（NC） あなたは営利目的でこの資料を利用してはなりません。 継承（SA） もしあなたがこの資料をリミックスしたり、改変したり、加工した場合には、あなたはあなたの貢献部分を元の作品と同じライセンスの下に頒布しなければなりません。 CC 4.0 BY-NC-SA "],["how-to-read.html", "0.1 How to read", " 0.1 How to read 本書は基本的なコンピュータの知識と基本的な統計の知識を有している読者におすゝめします。本書は R の実行環境構築に関する詳細な解説を行いませんので、実行環境の構築に不安がある方は次章で紹介している無料のクラウドサービスをご利用ください。 "],["introduction.html", "Chapter 1: Introduction", " Chapter 1: Introduction データ分析を行うためには適切な分析ツールが必要不可欠です。 R は統計計算に特化しているオープンソースの言語でデータ分析に最適なツールのひとつです。R がデータ分析に向いている理由をまとめているのが “Six Reasons To Learn R For Business”, R Blogger です。 R Has The Best Overall Qualities R Is Data Science For Non-Computer Scientists Learning R Is Easy With The Tidyverse R Has Brains, Muscle, And Heart R Is Built For Business R Community Support R はデータ分析に必要となるデータのハンドリングや可視化、モデリング、そして、レポーティングといった様々な機能を無料で利用することができます。また、R は逐次実行のインタプリタ型言語ですのでソフトウェアメトリクス分析のような探索的分析（Exploratory data analysis）に適していると言えます。さらに、非常にフレンドリーかつ活発なコミュニティーが日本でも形成されていますので、悩んだ時などに気軽に質問・相談ができるのも大きな強みです。 "],["how-to-analize.html", "1.1 How to analize", " 1.1 How to analize 分析対象のデータがどのようなものかを知ることは、データ分析を行うにあたって重要なことです。どのような分布なのか、どのような値の範囲なのか、全てのデータが揃っているのかなど俯瞰して把握します。 Visualize/Transform データを俯瞰するためには可視化（Visualize）が分かりやすい手法の一つです。例えば、計量値や計数値であれば棒グラフを用いて分布を確認したり、 だた、棒グラフでは今ひとつ分布の状況が分かりませんので、度数を求めてヒストグラムを描いたり、五数要約を求めて箱ひげ図を描くことでよりデータの分布（状況）を把握することができるようになります。 with(iris, tapply(Sepal.Width, Species, fivenum)) ## $setosa ## [1] 2.3 3.2 3.4 3.7 4.4 ## ## $versicolor ## [1] 2.0 2.5 2.8 3.0 3.4 ## ## $virginica ## [1] 2.2 2.8 3.0 3.2 3.8 with(iris, tapply(Sepal.Length, Species, fivenum)) ## $setosa ## [1] 4.3 4.8 5.0 5.2 5.8 ## ## $versicolor ## [1] 4.9 5.6 5.9 6.3 7.0 ## ## $virginica ## [1] 4.9 6.2 6.5 6.9 7.9 with(iris, hist(Sepal.Width, plot = FALSE))$count ## [1] 4 7 13 23 36 24 18 10 9 3 2 1 つまり、データの把握（分布の把握）とは可視化（Visualize）と変換（Transform）の繰り返し作業と言えます。 Model Communicate 1.1.1 Import/Tidy 1.1.2 Program "],["data-science-workflow.html", "1.2 Data Science Workflow", " 1.2 Data Science Workflow データ分析の方法は様々ですが、そのプロセスは下図のように抽象化することができます。 Fig 1.1: Data Science Workflow, CC BY-NC-ND 3.0 US, Hadley Wickham この図は「Data Science Workflow」と呼ばれ、R コミュニティに多大な貢献をしている Hadley Wickham がその著書 『R for Data Science』 で提唱している概念図です。本書は、この Data Science Workflow に基づくページ構成になっており各プロセスのスコープ概略は下記の通りです。 Program データ分析のすべてのプロセス（Tidy 〜 Communicate/Automate）で必要となるツールがプログラミングです。プログラミングを覚えることで効率的に分析処理を行えるようになります。 Import 分析対象となるデータを分析環境に取り込み分析をできるようにするのがインポートプロセスです。データは様々な形式（文字コード、ファイル形式など）で保存されていますので、それらに見合った方法でインポートする必要があります。 Tidy インポートしたデータは必ずしもデータ分析に適した形式になっているとは限りませんので、一貫した形式（Tidy data）に整理します。 Tidy data はデータ分析において重要な概念です。 Transform 整理したデータ（Tidy data）がそのまま状態でデータ分析に使えることは稀です。不要なデータを削除したり（クレンジング）、必要なデータだけに絞り込んだり、新しい変数を計算したりする必要があります。 Tidy プロセスと合わせて Wrangle や Data wrangling、前処理と呼ばれることもあります。 Visualize データを可視化することは様々な示唆を得ることと同義といえます。分析方針を考えるためにもデータがどういう傾向をもっているのかを把握するためのプロセスともいえます。 Model 可視化で得られた情報を元に数式可（モデル化）するのプロセスです。モデルは様々な Communicate 分析結果を他人に伝えるためのプロセスです。結果を他人に伝えるだけでは不十分で 再現可能性（Reproducible research） が伴っていることも求められます。 3つの再現可能性 "],["tidyverse-eco-system.html", "1.3 Tidyverse Eco System", " 1.3 Tidyverse Eco System このような Data Science Workflow を R で実現するための手段が Hadley Wickham により開発された tidyverse パッケージ群による Tidyverse Eco System です。tidyverse "],["environments.html", "Chapter 2: Environments", " Chapter 2: Environments R について学ぶ前に R が使えるように環境を構築する必要がありますが、環境構築は初学者にとって厄介な部分でもあります。そこで、本書では環境構築の必要がない binder を利用します。RStudio 環境を構築できる方はそちらを利用しても構いません。 binder による環境を利用するには以下のリンクをクリックしてください。Docker イメージのキャッシュが存在しない場合には Docker イメージの構築から行われますので起動するまでに多少の時間がかかります。 Run Tutorial on binder "],["import.html", "Chapter 3: Import", " Chapter 3: Import Import は Google Colab を利用する場合は［＋コード］（［Ctrl］+［M］+［Ctrl］+［B］）ボタンでコードを追加してコードブロックを挿入してからコードを記載します。コードブロックの移動や削除はブロック右側に表示されているサブメニューで行います。［＋テキスト］ボタンでテキストブロックを挿入すればコメントなどを書き込むことができます。 RStudio を利用する場合はメニューから［File］-［New File］-［R Notebook］を実行してR Notebook を作成します。キーボードショートカット［Ctrl/Cmd］+［Alt/Option］+［I］でコードチャンクを挿入しチャンクにコードを記述します。チャング以外にコメントなどを書き込むことができます。 "],["readr.html", "3.1 readr", " 3.1 readr "],["readxl.html", "3.2 readxl", " 3.2 readxl "],["pdftools.html", "3.3 pdftools", " 3.3 pdftools "],["tidy.html", "Chapter 4: Tidy ", " Chapter 4: Tidy "],["tidy-data.html", "4.1 Tidy Data", " 4.1 Tidy Data "],["longer.html", "4.2 longer", " 4.2 longer "],["wider.html", "4.3 wider", " 4.3 wider "],["transform.html", "Chapter 5: Transform ", " Chapter 5: Transform "],["filter.html", "5.1 filter", " 5.1 filter "],["rename.html", "5.2 rename", " 5.2 rename "],["select.html", "5.3 select", " 5.3 select 5.3.1 select helpers "],["mutate.html", "5.4 mutate", " 5.4 mutate "],["summarize.html", "5.5 summarize", " 5.5 summarize "],["base-r.html", "Chapter 6: Base R ", " Chapter 6: Base R "],["plot.html", "6.1 plot", " 6.1 plot "],["boxplot.html", "6.2 boxplot", " 6.2 boxplot "],["hist.html", "6.3 hist", " 6.3 hist "],["ggplot2.html", "Chapter 7: ggplot2", " Chapter 7: ggplot2 "],["test.html", "Chapter 8: Test", " Chapter 8: Test "],["linear-model.html", "Chapter 9: Linear model", " Chapter 9: Linear model "],["machine-learning.html", "Chapter 10: Machine Learning", " Chapter 10: Machine Learning "],["r-markdown.html", "Chapter 11: R Markdown", " Chapter 11: R Markdown "],["shiny.html", "Chapter 12: shiny", " Chapter 12: shiny "],["environments-2.html", "Chapter 13: Environments 2", " Chapter 13: Environments 2 R について学ぶ前に R が使えるように環境を構築する必要がありますが、環境構築は初学者にとって厄介な部分でもあります。そこで、本書では学習レベルに合わせて以下のように環境を使い分けることをおすゝめします。 学習フェーズ 環境 備考 基礎学習フェーズ Google Colaboratory 要Googleアカウント 応用学習フェーズ RStudio Cloud beta edition 環境を構築するための基本的な知識がある方は最初から RStudio Dekstop（以降、RStudio）を利用しても構いません。 "],["google-colaboratory.html", "13.1 Google Colaboratory", " 13.1 Google Colaboratory R の言語仕様など基礎的な学習フェーズでは環境構築の手間がかからないクラウド型の Google Colaboratory（以降、Google Colab）の利用をおすゝめします。Google Colab では Jupyter Notebook というデータ分析用のツールが使えます。ただし、デフォルトの状態で R を使うのは少し不便なので、以下の手順でファイルを準備します。 ブラウザで Google アカウントにログインする Google Colab を開く R 用のテンプレートファイルをアップロードする R のコードが実行できることを確認する アップロードしたファイルを Google ドライブに保存する 13.1.1 Login Google Google Colab は名前通り Google が提供しているサービスですので Google のアカウントを持っていることが前提になります。また、Chrome 系（含む Chromium 系）のブラウザで利用することをおすゝめします。 まず、ブラウザで Google のページを開きます。ページの右上に［ログイン］と表示されている場合は［ログイン］をクリックしてログインしておきます。 13.1.2 Open Google Colab Google で Google Colab を検索して Colaboratory - Google Colab のリンクをくと以下のような画面が表示されまます。 Fig 13.1: Google Colab, Theme: dark 画面テーマは右上の歯車ボタンから変更できます。 13.1.3 Upload Template Google Colab が立ち上がりましたら上部にあるメニュー ［ファイル］-［ノートブックをアップロード…］を実行します。 Fig 13.2: Upload notebook file アップロード用のダイアログが開きますので［GitHub］タブをクリックし、上段のライン（画像の青線部分）に下記の URL を入力します。入力後、右端にある虫眼鏡アイコンをクリックします。 https://gist.github.com/k-metrics/464ffbbd4d00e328560cd55966e7d4b8 Fig 13.3: Upload from GitHub テンプレートがアップロードされ表示されます。 13.1.4 Run R code テンプレートがアップロードできましたらテンプレートファイルの記述にしたがってコードを実行してみます。その際に下記のようなダイアログが表示されますが認証情報などを読み取ることはありませんので［このまま実行］をクリックしてください。 Fig 13.4: Warning dialog サーバ（ホスト型ランタイム）との接続するため実行までに多少時間がかかります。 13.1.5 Save File コードの実行が確認できましたらメニューの［ファイル］-［ドライブにコピーを保存…］を実行してコピーを Google Drive に保存します。以降、この保存したファイルを利用してください。 "],["rstudio-cloud.html", "13.2 RStudio Cloud", " 13.2 RStudio Cloud Google Colab では R Markdown などのレポーティング機能は使用できませんので、このような場合には クラウド上で RStudio が利用できる RStudio Cloud が便利です。RStudio Cloud は統合開発環境の RStudio だけでなく種々のチュートリアルコンテンツを備えています。 Fig 13.5: RStudio Cloud, beta 執筆時点では無償で利用することができ、無制限のプロジェクトとプライベートプロジェクトの作成が可能です。RStudio Cloud を利用するにはアカウントを取得するだけです。 ブラウザで RStudio Cloud を開く 右上の［sign up］をクリックする RStudio Cloud のアカウントを作成してサインアップするか、Google または GitHub のアカウントでログインする 13.2.1 Create Project RStudio Cloud ではプロジェクトという単位で分析を管理しますので、最初にプロジェクトを作成します。作成手順については RStudio Cloud メニューにある［Guide］で確認してください。ガイドは全て英語ですが、 Chrome 系のブラウザであれば「Google翻訳」機能拡張を用いれば日本語に翻訳表示できます。 プロジェクトを作成すると下図のような統合開発環境の RStudio が表示されます。RStudio 自体の説明は Appendix を参照してください。 Fig 13.6: Initial View 13.2.2 Install Packages RStudio Cloud の初期状態では R のパッケージは Base R しかインストールされていません。最も利用する tidyverse パッケージと rmarkdown パッケージをインストールするために右下のエリアにある Packages タブをクリックしてパッケージマネージャを表示させます。 Fig 13.7: Packages Manager 次にパッケージマネージャの上部に表示されている install ボタンをクリックし表示されたダイアログに tidyverse, rmarkdown と入力し［install］ボタンをクリックしてインストールします。 Fig 13.8: Install Dialog 以上で、RStudio Cloud の準備は完了です。 "],["install-rrstudio.html", "Appendix A: Install R/RStudio", " Appendix A: Install R/RStudio R について学ぶ前に R が使えるように環境を整えます。本書は R, RStudio, tidyverse/ パッケージならびにその他必要なパッケージの利用を前提としています。 R ならびに RStudio はマルチプラットフォーム対応（マルチOS対応）ですので Windows, macOS, Linux のどのプラットフォームを選択しても構いません。ただし、64bit プラットフォームであることが条件です。なお、日本語版 Windows では Windows が利用してる文字コード（CP932, Shift JIS）に起因する不具合が散見されています。日本語版 Windows 環境を利用する場合はその点を認識の上で利用してください。 環境を整えるための手順は以下のようになります。 手順 実施内容 備考 1 Rのインストール 64bit プラットフォーム 2 Rtoolsのインストール Winodws のみ 3 RStudioのインストール Desktop 版 4 パッケージのインストール tidyverse, rmarkdown 5 Gitのインストール 任意 Git は VCS(Version Control System) と呼ばれるソースの版管理を行うシステムです。必要な場合のみインストールしてください。 "],["install-r.html", "A.1 Install R", " A.1 Install R R は CRAN (The Comprehensive R Archive Network) と呼ばれる公式リポジトリから入手してインストールします。 CRAN には ミラーサイト も多数ありますので、利用しているインターネット環境に応じて近いサイトからダウンロードしてください。 よくある質問は FAQ(Frequently Asked Questions) にまとめられています。 A.1.1 Windows Winodws では特段の理由がない限り CRAN から最新バージョンをインストールしてください。 旧バージョンをインストールしたい場合は Previous Releases of R for Windows から当該バージョンをダウンロードしインストールしてください。 日本語によるインストール方法が必要な場合は非公式ページですが R初心者の館（RとRStudioのインストール、初期設定、基本的な記法など） などのサイトを参考にしてください。 A.1.1.1 Rtools Windows ではコンパイラなどの開発ツール類が標準装備されていませんので、 R のパッケージをインストールする際に必要となる Rtools と呼ばれるツールキットをインストールしておきます。 Building R for Windows のページからインストールした R のバージョン用の Rtools をダウンロードしてインストールしてください。なお、インストールの際はデフォルトオプションでインストールしてください。インストールディレクトリなどを変更すると正しく動かない場合があります。 A.1.2 macOS (OS X) macOS ではインストールできるバージョンが限られていますので CRAN で確認の上でインストールしてください。 A.1.3 Linux R がサポートしているディストリビューションは Debian, RedHat, Suse, Ubuntu のみです。Fedora を利用したい場合には README を参照の上で RedHat Software のリポジトリからインストールしてください。 Linux の場合、ディストリビューションごと・バージョンごとにインストール方法が異なりますので各ディストリビューション用のディレクトリ内の README ファイルを参考にインストールしてください。 "],["install-rstudio-desktop.html", "A.2 Install RStudio Desktop", " A.2 Install RStudio Desktop R のインストールが完了しましたら統合開発環境（IDE）である RStudio Desktop をインストールします。 Downloadページ から使用している環境（OS）用の RStudio をダウンロードしてインストールしてください。 A.2.1 動作確認 RStudio のインストールが完了したら RStudio を起動します。下図のようなウィンドウが立ち上がり左側の Console ペインに R のバージョンなどが表示されます。 Console ペインのプロンプト（&gt;表示）の部分に2 * 3と打ち込んで［Enter］キーを押し[1] 6と表示されることを確認してください。 2 * 3 [1] 6 "],["install-r-packages.html", "A.3 Install R packages", " A.3 Install R packages 次に必要となるいくつかのパッケージをインストールします。パッケージをインストールする場合はインターネットに接続されている必要があります。 Console ペインのプロンプトに以下のコードを入力し [Enter]キーを押して実行します。 install.packages(&quot;tidyverse&quot;) インストールが終わりましたらパッケージが正しくインストールされていることを確認するために Console ペインに以下のコードを入力して実行します。 library(tidyverse) 以下のようなメッセージが表示されることを確認します。インストール時期によってはバージョン表記などが下記と異なる場合があります。なお、日本語版 Windows 環境では一部の文字が化けします。 Loading required package: tidyverse ─ Attaching packages ─────────────────────────────── tidyverse 1.3.0 ─ ✔ ggplot2 3.2.1 ✔ purrr 0.3.3 ✔ tibble 2.1.3 ✔ dplyr 0.8.3 ✔ tidyr 1.0.0 ✔ stringr 1.4.0 ✔ readr 1.3.1 ✔ forcats 0.4.0 ─ Conflicts ───────────────────────────────── tidyverse_conflicts() ─ ✖ dplyr::filter() masks stats::filter() ✖ dplyr::lag() masks stats::lag() 続いて rmarkdown パッケージをインストールします。tidyverse パッケージのときと同様に以下のコードを Console ペインに入力して実行します。 install.packages(&quot;rmarkdown&quot;) A.3.1 Linux環境の場合 Linux環境ではプラットフォーム側のライブラリなどが足りずにパッケージのインストールが完了できない場合があります。その場合は RStudio Package Manager, demo site にてインストールしたいパッケージが必要とするライブラリなどを確認、インストールしてから再度パッケージをインストールしてください。 例えば Ubuntu 18.04LTS で R に tidyverse パッケージをインストールする場合には以下のようなライブラリなどがOS側にインストールされている必要があります。 apt-get install -y libicu-dev apt-get install -y make apt-get install -y libcurl4-openssl-dev apt-get install -y libssl-dev apt-get install -y pandoc apt-get install -y libxml2-dev "],["install-git.html", "A.4 Install Git", " A.4 Install Git RStudio にはソースコードの版管理を行うインタフェースが標準で用意されていますが、版管理システム（以降、VCS）を別途インストールする必要があります。RStudio で利用できる VCS は以下の二つです。 Git Subversion(SVN) どちらを利用しても構いませんが GitHub などのクラウドサービスが充実している Git の利用をおすゝめします。 A.4.1 Git Windows および macOS は Gitの ダウンロードページ から最新バージョンをダウンロードしてインストールします。Linux はリポジトリからインストールするか ダウンロードページ から最新バージョンをダウンロードしてインストールしてください。 A.4.2 Git Client RStudio には簡易的な Git のクライアント機能が標準で用意されていますが、きめ細かな操作を行いたい場合には Git の GUI クライアントをインストールしてください。代表的な Git Client を以下に列挙しておきます。 Git GUI Client Ubuntu Mac Windows Memo GitKraken Yes Yes Yes Free版は機能制限あり SmartGit Yes Yes Yes Free版でも機能制限なし1 GitEye Yes Yes Yes Sourcetree No Yes Yes 日本語版あり GitHub Desktop No Yes Yes 1 : 非商用利用の場合 "],["rstudio-server.html", "Appendix B: RStudio Server", " Appendix B: RStudio Server R/Rstudio Desktop は前述のようにマルチプラットフォーム対応ですがプラットフォームごとに以下のような制約があります。 日本語版 Windows 環境では文字コード（CP932, Shift JIS）が原因で日本語を正しく処理できない事例が散見される 18.04LTSより前の Ubuntu 環境では RStudio Desktop で日本語入力ができない * 有志による日本語入力パッチ（非公式パッチ）はあり macOS 環境ではグラフの日本語が文字化けする * いわゆる豆腐文字問題 特に日本語版 Windows 環境での問題は Windows が利用している文字コード（CP932, Shift JIS） に起因しているため問題は根本的な解決を期待できません。詳細については伝説とも言われている「Why are you using SJIS?」というキーワードで検索してみてください。 日本語版 Windows 環境における文字コード問題を回避するためには、 RStudio Server を利用する方法が考えられます。 RStudio Server は Linux 環境で動作する Web サーバベースの IDE ですが、 Docker のコンテナ技術を利用することで Windows や macOS 環境で動作させることが可能です。 OS Docker app System Requirements macOS Docker Desktop for Mac refer docker docs Windows Docker Desktop for Windows Hyper-V(Windows10 64bit Pro or Higher) or WSL21 1 WSL2 は Windows10 version 2004 から利用可能になる予定です "],["setup-rstudio-sever-with-docker.html", "B.1 Setup RStudio Sever with Docker", " B.1 Setup RStudio Sever with Docker Windows または macOS 環境で Docker を利用し RStudio Server を起動するためには以下の手順が必要です。 手順 実施内容 備考 1 Hyper-V の有効化 Windows のみ 2 Docker Desktop のインストール 3 Docker Image のダウンロード 4 Docker Container の起動 なお、Linux 環境での手順は割愛します。 B.1.1 Enable Hyper-V (Windows Only) Windows 環境ではインストールする前に Hyper-V を有効にする 必要があります。 B.1.2 Download and Install Docker Desktop 利用している環境に応じた Docker Desktop をダウンロードしてインストールします。なお、ダウンロードには docker hub でアカウント登録が必要です。 詳細な手順や設定方法は Docker docs を参照してください。 B.1.3 Download Docker Image Docker Desktop をインストール・起動しましたら RStudio Server の Docker Image をダウンロードします。様々な方が RStudio Server の Docker Image を公開されていますが代表的な Docker Image には次のようなものがあります。 Image Description rocker/tidyverse Version-stable base R and RStudio, tidyverse, devtools rocker/verse Adds TeX and related packages to rocker/tidyverse ykunisato/paper-r-jp Dockerfile of writing paper by R Markdown kmetrics/jverse Japanized rocker/verse rocker は準公式とも言えるような R に関連する Docker Image を継続的に提供しているプロジェクトです。様々なイメージを提供していますが残念ながら日本語フォントの追加などの日本語対応がなされていません。グラフで日本語を利用しない限りは rocker のイメージを利用しても何ら問題はありません（ソースなどの表示はブラウザに依存しているのでコードに日本語を記述することが可能です）。 グラフで日本語を利用したい場合は著者が rocker/verse に日本語フォントなどを追加して日本語対応させた kmetrics/jverse を利用するか rocker が公開している Dockerfile を改修して日本語対応させたイメージを利用してください。 利用する Docker Image を決めたらコンソール（コマンドプロンプト）で以下のコマンドを実行してイメージをダウンロードしてください。 docker pull rocker/tidyverse B.1.4 Run Container "],["rstudio-ide.html", "Appendix C: RStudio IDE", " Appendix C: RStudio IDE データ分析勉強会では長らく R Commander（以降、Rcmdr） が利用されています。勉強会の母体となっている SQiP研究会 のソフトウェアメトリクスに関する演習コースでも同様です。これはプログラミングに縁の薄いソフトウェア品質管理技術者が短期間で R を用いた分析を行えるようにとの配慮からです。実際、 Rcmdr はコードを記述しなくてもデータの可視化や分析ができますのでデータ分析の初学者にとっては R の恩恵を簡単に受けられる非常に便利な道具です。 しかし、Rcmdr は R のごく一部の関数を GUI で使えるようにしたラッパープログラムですので、できることが非常に限られています。加えて GUI 操作なため操作自体が記録に残りません。つまり、探索的にデータを分析を行ってもその手順分析者の記憶に依存してしまいますので分析再現性の観点から見ると好ましい分析環境とは言えません。 本格的な探索的データ分析を行うには、出来ることが限られる Rcmdr ではなく R のスクリプトを用いるべきです。しかし、 R 本体（R Console）は非常に機能が限られていますので、それだけで探索的データ分析を行うのは非常に困難です。そこで、初学者には様々な機能を予め備えている統合開発環境（IDE - Integrated Development Environment）を利用をおすゝめします。 R 用統合開発環境のデファクトスタンダードと言えるのが RStudio, PBC の RStudio IDE （以降、RStudio） です。無償版である Open Source Edition でも全ての基本的な機能を利用できます。 初学者にとって RStudio には以下のような便利な機能があります。 補完機能が強力 関数名・変数名・パッケージ名などを補完してくれますので入力負荷が大幅に減ります エディタ機能が強力 キーひとつでヘルプの参照が可能ですので即座に疑問が解決できます 部分的にコードを実行できますので手順を確認しながらコーディングできます Markdown 記述が使えますので分析と報告書作成を同時に進められます コードの直下に実行結果を表示することができますのでコードと実行結果の関係性が一目でわかります パッケージ管理が分かりやすい インストールされているパッケージが一目でわかります パッケージの検索・読込み・インストールが GUI 操作で簡単にできます その他の便利な機能 作成した変数を一覧で確認できると共に値も確認できます プロジェクト管理機能が使えますので分析ごとにファイルなどをセパレートできます バージョンコントロールシステムを用いた履歴管理ができます Python などの他言語もサポートしています 上記は機能のほんの一部を紹介したにすぎません。 RStudio は R を利用した探索的データ分析を効率的かつ強力にしかも無償でサポートしてくれる道具です。 "],["overview.html", "C.1 Overview", " C.1 Overview RStudio を起動すると以下のような画面が表示されます。画面は大きく以下の四つのエリアに分割されており、左上の A のエリアはソースエディタが表示されるエリアなので初めて起動した際には表示されません。 Fig C.1: RStudio Desktop, Windows 各エリアのサイズ（ウィンドウ内での比率）は任意に調整できますが、横幅に関しては A と B 、 C と D が常に同サイズとなります。各エリアにはペインと呼ばれるタブ切り替え型のサブエリアが表示されます。ペインは常時表示されるペイン（下図の黒文字）と機能が呼び出されたり利用を設定している場合にのみ表示されるペイン（下図の灰文字）があります。 Fig C.2: RStudio Pane Layout, Windows RStudio のバージョンにより多少ペイン構成が異なりますが以下のペインが用意されています。これらのペインはグローバルオプションで表示位置の変更や表示・非表示の切り替えができます。 No Area Pane name Descriptions 1 A (File name) ソースエディタ（ファイルが開かれていない場合は未表示） 2 A (Data name) データフレーム型の変数などを表示するデータビューア 3 B Console 文字通りRのコンソール（実行結果の表示だけでなくここから実行することも可） 4 B Terminal OS のターミナル（RStudio v1.1から） 5 B R Markdown R Markdown ファイルをレンダリングした際にレンダリング情報を表示 6 B Jobs ローカルジョブの実行マネージャ（RStudio v1.2から） 7 C Environment オブジェクト（変数、関数）の表示と参照ができる環境マネージャ 8 C History 実行履歴マネージャ（コンソールでの実行、ソースからの実行共に記録） 9 C Connections データソース接続マネージャ（RStudio v1.1から） 10 C Build ビルドツール（プロジェクトオプションで有効にしている場合のみ） 11 C Git or SVN 簡易VCSクライアント（プロジェクトオプションでVCSを有効にしている場合のみ） 12 D Files 簡易なファイルマネージャ 13 D Plots グラフィック専用プロットエリア（ヒストリ機能、出力機能付き） 14 D Packages パッケージ管理を行うためのパッケージマネージャ 15 D Help ヘルプビューア（ソースエディタやコンソールと連動したヘルプ表示が可） 16 D Viewer HTML等の表示が可能なビューア "],["keyboard-shortcuts.html", "C.2 Keyboard Shortcuts", " C.2 Keyboard Shortcuts キーボードショートカットは効率的なコーディングに役立ちますので、最低限、以下のショートカットを覚えましょう。 Keyboard Shortcuts Description ［TAB］ 入力中のコード（オブジェクト）を補完 ［Alt/Option］+［-］ 代入演算子（&lt;-）をカーソル位置に挿入する ［Ctrl/Cmd］+［Shift］+［M］ パイプ演算子（%&gt;%）をカーソル位置に挿入する ［Ctrl/Cmd］+［Shift］+［C］ 選択行をコメント・アンコメントする（トグル動作） ［Ctrl/Cmd］+［Alt/Option］+［I］ カーソル位置にコードチャンクを挿入する（R Markdownのみ） ［Ctrl/Cmd］+［Enter］ 選択したコードを実行する（行選択、部分選択どちらも可） ［Ctrl/Cmd］+ [Shift] +［Enter］ コードチャンク内の全てのコードを実行する（R Markdownのみ） ［F1］ 選択またはカーソル位置の関数のヘルプを呼び出す ［Ctrl/Cmd］+［F］ アクティブなペイン内の検索 上記以外のショートカットはメニュー［Tools］-［Keyboard Shortcuts Help］を選択すると表示できます。 "],["writing-r-code.html", "C.3 Writing R code", " C.3 Writing R code では、実際に RStudio を利用して簡単なコードを書いてみましょう。初学者が学習のために R のコードを記述するには R Notebook 形式が便利です。 R Notebook 形式は マークダウン言語とコードを混在できる R Markdown 形式を簡易にしたものです。コード以外に説明などを記述できるのでアウトプットしながらの学習が可能です。 R Notebook 形式を使うにはメニューから［File］-［New File］-［R Notebook］を実行します。すると下図のようなソースエディタ（以降、エディタ）が開きます。 Fig C.3: R Notebook file この時点ではファイルとして保存されていませんので、メニューから［File］-［Save As…］を実行して適当な場所に適当な名前で保存しておきます。ここでは test という名前を入力して保存します。ファイルの拡張子が自動的に付与されますのでタブの表示は test.Rmd となります。 Fig C.4: R Notebook saved file ファイルを保存したら 6 行目の「This is an …」から 18 行目の「in the editor is displayed.」までを削除し、カーソルの位置（6 行目）でキーボードショートカット［Ctrl/Cmd］+［Alt/Option］+［I］を押下してコードを記述するためのブロックを挿入します。 Fig C.5: R Notebook insert chunk すると上図のように三連のバッククォート（```）で囲まれたブロックが挿入されます。このブロックはコードチャンクと呼ばれる R のコードを記述する部分です。コードチャンクの前後は自由な記述が出来ますので、以下のように入力してみてください。 Fig C.6: R Notebook first code 上図のように R Notebook では説明とコードを混在することができます。では、コードチャンクの右上にある緑色の三角マークをクリックしてコードを実行してみましょう。 Fig C.7: R Notebook run code コードチャンクの下と Console ペインに実行結果が表示されます。コードチャンクの下に実行結果が表示されない場合は下図のように歯車アイコンをクリックし表示したメニューから Chunk Output Inline にチェックをつけ、再度、緑色の三角マークをクリックしてコードを実行してください。コードチャンクの下に実行結果が表示されます。 Fig C.8: R Notebook option 最後にフロッピーディスクアイコンをクリックするかキーボードショートカットの［Ctrl/Cmd］+［S］を押下してファイルを保存しておきます。 "],["global-options.html", "C.4 Global Options", " C.4 Global Options メニュー［Tools］-［Global Options…］を選択すると表示できます。以降に推奨設定項目を記載しておきますので参考にしてください。記載されていないオプションはお好みで設定してください。 C.4.1 General Genelal オプションは RStudio の全般的な動作に関する設定です。 Basic と Advanced の二種類の設定がありますが、初学者の方は Basic のみ以下のように設定しておくと便利です。 大項目(Tab) 中項目(太文字) 設定項目 推奨設定 Basic R Sessions R version Default（Windows only） Basic R Sessions Default working directory 任意のディレクトリ Basic R Sessions Restore most recently opened project at startup Unchecked Basic Workspace Restore .RData into workspace at startup Checked Basic Wrokspace Save workspace to .RData on exit “Ask” or “Always” Basic Ohter Automatically notify me of updates to RStudio Checked 特に “Default working directory” はプロジェクトを作成・管理するディレクトリに設定しておくと便利です。 C.4.2 Code Code オプションはソースエディタの動作に関する設定です。ソースの記述は スタイルガイド（The tidyverse style guide） に準拠することをおすゝめしますので、設定例もスタイルガイドに沿ったものになっています。なお、 Python などの他言語を併用する場合は適切な設定に変更してください。 大項目(Tab) 中項目(太文字) 設定項目 推奨設定 Editing General Insert spaces for tab Checked Editing General Tab width 2 Editing General Auto-detect code indentation Checked Editing General Insert matching parens/quotes Checked Editing General Auto-indent code after paste Checked Editing General Vertically align arguments in atuo-indent Checked Editing General Surround selection on text insertion “Quotes &amp; Brackets” Editing Execution Always save R scripts before sourcing Checked Editing Execution Ctrl+Enter executes “Multi-line R statement” Display General Highlight selected word Checked Display General Highlight selected line Checked Display General Show line numbers Checked Display General Show margin Checked Display General Margin coloumn 80 Display General Show whitespace characters Checked Display General Show syntax highlighting in console input Checked Saving General Restore last cursor position when opening file Checked Saving Serialization Line ending conversion “Posix (LF)” Saving Serialization Default text encoding “UTF-8” C.4.3 Appearance Appearance オプションは RStudio の見た目に関する設定です。フォント設定のみ日本語の固定ピッチフォントに変更し、その他はお好みでどうぞ。 大項目(Tab) 中項目(太文字) 設定項目 推奨設定 N/A N/A Editor font 任意の日本語等幅フォント 日本語等幅フォントは好みで構いませんが、無償ダウンロード可能な以下のフォントがおすゝめです。 BIZ UDゴシック（macOS, Windows） - MORISAWA PASSPORT Source Han Code JP（Linux, macOS） - SIL Open Font License IPAゴシック（Linux, macOS, Windows） - IPA フォントライセンス なお、日本語版 Windows の RStudio では一部の日本語等幅フォントを正しく表示できないバグがあるようですので、フォントの選択には注意してください。 C.4.4 Pane Layout Pane Layout オプションは前述のペインの表示場所や表示・非表示を変更するためのオプションですので、初学者はデフォルト設定のまま利用することをおすゝめします。 C.4.5 Packages Packages オプションはパッケージマネジメントに関する設定です。 Management と Development の二種類の設定がありますが、Development はパッケージ自体を開発するためのオプションですので Management のみ設定してください。 大項目(Tab) 中項目(太文字) 設定項目 推奨設定 Management Package Management Primary CRAN repository 任意のhttpsサイト1 Management Package Management Enable packages pane Checked Management Package Management Use secure download method for HTTP Checked Management Package Management Use Internet Explorer library/proxy for HTTP Checked 2 1 ネットワーク的に最も速い（近い）サイトを選んでください 2 プロキシサーバーを利用している場合に設定してください C.4.6 R Markdown R Markdown オプションは R Markdown に関する設定です。 大項目(Tab) 中項目(太文字) 設定項目 推奨設定 N/A R Markdown Show inline toolbar for R code chunk Checked N/A R Markdown Enable chunk background highlight Checked N/A R Markdown Show output preview in “Viewer Pane” N/A R Markdown Show output inline for all R Markdown documents Checked N/A R Markdown Show equation and image previews “Inline” or “In a popup” N/A R Markdown Evaluate chunks in directory “Document” N/A R Notebooks Execute setup chunk automatically in notebooks Checked N/A R Notebooks Hide console automatically when executing notebook chunks Checked C.4.7 Sweave Sweave オプションは R + \\(\\LaTeX\\) によるドキュメント作成に関する設定です。 Sweave を利用しない限り基本的に変更する必要はありませんが、 R Markdown で PDF ファイルを作成する場合は PDF ビューアに関する設定のみお好みのビューアを設定してください。 大項目(Tab) 中項目(太文字) 設定項目 推奨設定 N/A PDF Preview Preview PDF after compile using お好みのビューア C.4.8 Spelling Spelling オプションはスペルチェックのための設定です。UK または US の English を指定するのが無難です。 C.4.9 Git/SVN Git/SVN オプションはバージョンコントロールシステム（VCS）に対する設定です。VCS を利用する場合のみ設定してください。 C.4.10 Publishing Publishing オプションは RStudio, Inc. が提供しているサービスへドキュメントを発行する場合に利用する設定ですので、当該のサービスを利用する場合のみ設定してください。 C.4.11 Terminal Terminal オプションは OS のターミナルを RStudio の Terminal ペインから利用するための設定です。Terminal ペインを利用する場合のみ設定してください。 大項目(Tab) 中項目(太文字) 設定項目 推奨設定 N/A Shell New terminals open with 任意のシェル N/A Connection Connect with WebSockts Terminalが起動しない場合はチェックを外す "],["project-options.html", "C.5 Project Options", " C.5 Project Options メニュー［Tools］-［Project Options…］を選択すると表示できます。 Build Tools と Git/SVN を除いて基本的にグローバルオプションと同一の設定で構いません。 Build Tools オプションは R Markdown Website や Bookdown を利用する場合に以下のように設定するのをおすゝめします。 大項目 中項目（太文字） 設定項目 推奨設定 Build Tools N/A Project build tools “Website” Build Tools N/A Preview book after building Checked Build Tools N/A Re-knit current preview when supporting files change Checked Git/SVN オプションは VCS を利用する場合に利用する VCS を選択してください。VCS がインストールされていない場合は有効にできません。 "],["cloud-ide.html", "Appendix D: Cloud IDE", " Appendix D: Cloud IDE 開発環境のクラウドサービス化も進んでいます。 "],["rstudio-cloud-ga.html", "D.1 RStudio Cloud GA", " D.1 RStudio Cloud GA RStudio Colud は RStudio, PBC が提供している RStudio Server によるクラウドサービスです。2020年2月末時点では無料プランでも無制限のプロジェクトならびにプライベートなプロジェクトの作成が可能です。また、 learnr パッケージを用いた初学者用のチュートリアルなど学習資料が多数用意されているのも特徴です。 Fig D.1: RStudio Cloud, beta ただし、無料プランで使えるリソースはメモリ 1GB ・ 1CPU と限られていますので、ナイーブ・ベイズのようなメモリを必要とする機械学習プログラミングなどには向いていません。なお、 Google Colab のように24時間でインスタンスが消滅するというようなことは無いようです。 "],["exploratory.html", "D.2 Exploratory", " D.2 Exploratory Exploratory は BI（Business Intelligence）BI（Business Intelligence）ツールのような操作で R を持ちた探索的データ分析（EDA）が行える利用できる専用クライアントアプリケーションを用いるクラウドサービスです。無料で利用できますがオンライン限定・パブリックシェアオンリーとなりますので注意してください。 何ができるのか見てみる ページで多数の分析サンプルが公開されています。 また、 使い方ガイド ページにも様々な説明資料が用意されています。 Fig D.2: Exploratory Public 価格 ページからお好みのプランを選んでアカウントを取得します。クライアントアプリケーションは、mac まはた Windwos でしか動作しません。 "],["binder.html", "D.3 binder", " D.3 binder binder は 実行環境の再現性を確保するためのクラウドサービスです。指定したGit のリポジトリから自動的に Jupyter Notebook のコード実行環境（Docker イメージ）を構築しクラウド上で実行することによりリポジトリにあるソースコードを動作さあせることができます。リポジトリに設定ファイルを置くことで RStudio Server や Shiny 環境を構築・実行することも可能です。 Google Colab や RStudio Cloud・Exploratoy などと異なりアカウントを取得する必要はありませんが、専用の環境を構築するわけではなく、あくまでも一時的な試用環境である点に注意してください。継続的に使える環境が必要な場合は ローカルに環境を構築するか RStudio Cloud のようなクラウドサービスを利用してください。 "]]
