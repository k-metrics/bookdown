<!-- 
  本章で使っている"Number and reference equations"(番号付き数式とその参照)に
  ついては以下のページで解説されています。
  https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html
  
  図番号・表番号とその参照については
  https://speakerdeck.com/ktgrstsh/introduction-to-r-markdown-for-everyone?slide=58
  https://speakerdeck.com/ktgrstsh/introduction-to-r-markdown-for-everyone?slide=60
  
  \@ref(fig:チャンクラベル)
  \@ref(tab:チャンクラベル)
  
  数式記述のequation（1行のみ）, eqnarray（中央揃え？上手く揃わない）,
  align（&=位置を揃える）
  http://robomixcom.hatenablog.com/entry/2017/08/16/202606
-->

# Rの基本
**R**の文法説明が延々と続いてもつまらないので、本書では少し実用的な面から**R**のプログラミングを説明します。本チャプターでは『統計のはなし【改訂版】』`r if (knitr::is_latex_output())'[@ToukeinoHanashi]'`や『統計解析のはなし【改訂版】』`r if (knitr::is_latex_output())'[@ToukeiKaisekinoHanashi]'`を参考書として説明します。個々の詳細については、これらの書籍などを参照してください。
なお、基本文法については[Appendix R Basics](#Appendix-RBasics)をご覧ください。


## 尺度とデータ型
分析対象となるデータは質的データと量的データに分類することができます。質的データは性別や品名、会社名など主に文字で表すことができる非数値データです。量的データは、温度や身長・体重、売上金額といった数値で表すことができるデータです。

### 尺度水準
質的データや量的データはデータ自体がもつ意味により下記のような尺度と呼ばれる水準で分類することができます。

* 名義尺度
  * 区別のためのラベルとしての意味を持つデータ
  * 同値か否かの比較しかできない
* 順序尺度
  * 区別のためのラベルとしての意味に加えて順番や大小関係の意味を持つデータ
  * 順番や大小の間隔には意味がない
  * 同値または大小比較の比較演算が可能
* 間隔尺度
  * 大小関係に加えて数値の差に意味をもつデータ
  * 数値の間隔には意味がありゼロは相対的な意味しかもたない
  * 比較演算に加えて加減算が可能
* 比例尺度
  * 大小関係、数値の差に加えて数値の比にも意味をもつデータ
  * 数値の間隔に意味がありゼロは原点としての（絶対的な）意味をもつ
  * 比較演算に加えて加減乗除が可能
  * 比尺度とも呼ばれる


尺度水準 | 可能な演算 | データの例
---------|------------|--------------------------------
名義尺度 | 同値比較   | 名前、性別、背番号、血液型など
順序尺度 | 比較演算   | 着順、ランキング、段階評価など
間隔尺度 | 比較演算、加減算     | 温度、時刻、日付など
比例尺度 | 比較演算、加減乗除算 | 長さ、重さ、金額など


#### 名義尺度のデータ型
名義尺度を扱うには順序なし因子型（`factor`）というデータ型を用いるのが便利です。因子型は文字でも数字でも扱えます。
ただ、因子型では水準の追加・削除操作が厄介ですので、文字型、数値型


#### 順序尺度のデータ型
順序尺度は名義尺度のデータに順番や大小関係という属性を付与したデータと言えますので、順序付き因子型（`ordered`）というデータ型を用いるのが便利です。

#### 間隔尺度のデータ型
間隔尺度は数値のデータになりまので、データが取る値に合わせて、整数型（`integer`）、実数型（`numeric`）、日付型（`Date`）のデータ型を用います。

#### 比例尺度のデータ型
比例尺度は間隔尺度と同様に整数型（`integer`）や実数型（`numeric`）のデータ型を用います。



## 要約統計量
データを分析する前には分析対象となるデータがどのような特徴を持っているか確認しておくことが重要であるとよく言われます。この特徴を見るには要約統計量を使う場合が多いです。要約統計量はデータの分布の特徴を表すもので、記述統計量や基本統計量と呼ばれることもあります。


### 平均
算術平均（相加平均）は要約統計量の中でよく使われ、下式で求められます。
<!-- $$\bar{x} = \frac{x_1 + x_2 + \cdots + x_n}{n} = \frac{1}{n} \sum_{i = 1}^n x_i$$ -->

\begin{align}
  \bar{x} = \frac{x_1 + x_2 + \cdots + x_n}{n} = \frac{1}{n} \sum_{i = 1}^n x_i (\#eq:arithmetic-mean)
\end{align}

算術平均以外にも幾何平均（相乗平均）や
<!-- $$\sqrt[n]{x_1 \times x_2 \times \cdots \times x_n} = \sqrt[n]{\prod_{i = 1}^n x_i}$$ -->
\begin{align}
  \sqrt[n]{x_1 \times x_2 \times \cdots \times x_n} = \sqrt[n]{\prod_{i = 1}^n x_i} (\#eq:geometric-mean)
\end{align}

上記の他に値の下位・上位を任意の割合で除き平均（算術平均）を求めるトリム平均（刈込み平均・調整平均）という平均もあります。トリム平均は異常値や外れ値の影響を排除して平均を求めたい場合に利用されます。例えば体操競技で極端な点数を出す審査員の影響を排除するために使われます。この場合は全審査員の得点から最小と最大を除いたものから平均値を求め、その平均値を得点します。

平均といってもこのように様々な求め方がありますので、実際に**R**を使ってこれらの平均を求めてみます。

以降、灰色に網掛けされた部分が**R**のコード、コードの下の`##`で始まる部分が実行結果（出力）になります。コードによっては実行結果が出力されない場合もあります。


#### 算術平均
式\@ref(eq:arithmetic-mean)の算術平均は`mean()`関数で求めることができます。最初に平均の計算対象となるデータ（変数）を`c()`関数で作成します。`c()`関数はベクトル型の変数を作成する関数です。

```{r}
x <- c(1, 3, 3, 5, 7)
```

`x`は値を代入（格納）する変数、`<-`は代入演算子[^21]、`c()`関数はベクトルデータを作成する関数です。代入結果を確認するには以下を実行します。

[^21]: **R**では代入に`=`を使わないようにしてください


```{r}
x
```

算出平均は`mean()`関数に計算対象となる`x`を指定して実行します。

```{r}
mean(x)
```


#### トリム平均
トリム平均は算術平均のコードに引数`trim`を指定するだけです。引数`trim`は計算対象外にする割合を指定するオプションです。今回は五つのデータから最小値・最大値の二つを除いてトリム平均を求めますので$\frac{2}{5} = 0.2$を指定します。

```{r}
mean(x, trim = 0.2)
```

関数に指定できるオプションの引数を確認した場合場`?`に続いて関数名を`()`付きで打ち込んで実行してください。ヘルプが表示されます。

```{r, eval=FALSE}
?mean()
```


#### 幾何平均
式\@ref(eq:geometric-mean)の幾何平均（相乗平均）を求める関数は標準では用意されていません。パッケージを追加インストールする必要があります。ここでは**`psych`**パッケージを下記の手順でインストールして使います。なお、インストールに際してはインターネット接続が必要です。

1. パッケージをインストールする
1. パッケージを読み込む

パッケージのインストールは`install.packages()`関数を用います。`install.packages()`関数を実行すると環境によってはCRANミラーサイトの選択を促される場合があります。その場合は、最も近い地域のミラーサイトを選択してください。なお、パッケージのインストールは一度行えば次からのインストールは不要です。

```{r, eval=FALSE}
install.packages("psych")
```

インストールが完了しましたら`library()`関数を使ってパッケージを読み込みます。

```{r, eval=FALSE}
library(psych)
```

使用している環境によっては他のパッケージの関数をマスクしているなどのメッセージが出力されますが、今は気にする必要ありません。

これで**`psych`**パッケージを使う準備が整いましたので、`geometric.mean()`関数で幾何平均を求めます。

```{r}
geometric.mean(x)
```

インストールしたパッケージの関数を使う場合、どのパッケージの関数を使っているかを明示的に示すために下記のように`::`演算子（名前空間へのアクセス演算子という）でパッケージ名と関数名をつなげて記述することもできます。

```{r}
psych::geometric.mean(x)
```

この表記方法については賛否ありますが、どのパッケージの関数を使っているかが分かりやすいので本書ではこの記述方法を用います。



#### 閑話 {.unnumbered}
**パッケージ四方山話**  
　幾何平均を求めるために`psych`パッケージを利用しましたが、**R**には総積（$x_1 \times x_2 \times \cdots \times x_n$）を求める`prod()`関数と累乗根（$x^{\frac{1}{n}}$）を求めるべき乗演算子（`^`）がありますので、これを組み合わせれば幾何平均を求めることが可能です。

```{r}
prod(x) ^ (1 / length(x))
```

`length()`関数は変数`x`の長さ（変数`x`の中にある値の個数）を求める関数です。

幾何平均は全ての値を`prod()`関数で乗算しますのが、データの数が多い場合やデータの値が大きい（または、小さい）場合に`prod()`関数がオーバーフロー（または、アンダーフロー）を起こしてしまうことがあります。例えば、$1$から$200$までを乗算するとオーバーフローを起こします。

```{r}
prod(c(1:200))
```

一方、`geometric.mean()`関数は対策が施されていますのでオーバーフローを起こすことなく幾何平均を求めることができます。

```{r}
psych::geometric.mean(c(1:200))
```

このように既にパッケージで提供されている関数があれば、自分でコードを組むよりはパッケージを導入した方が早くて確実です（ここでの本来の目的は幾何平均を求めることでなくデータの特徴を掴むことです）。特に**CRAN**に登録されているパッケージは審査が行われていますので、使わないよりは使った方が確実に目的を達成しやすくなります。**R**には先人の知恵が結集していますので、車輪の再発明に挑戦するより先人の知恵を活用する方をおすゝめします。

<!-- \newpage -->

### 分散・標準偏差
データの散らばり具合を見るには分散・標準偏差がよく使われます。例えば、以下の`x`と`y`が取る値の範囲は同一ですが、同じ散らばり具合と言えるでしょうか？

```{r}
x <- c(1, 5, 5, 5, 9)
range(x)
y <- c(1, 1, 5, 9, 9)
range(y)
```

散らばり具合を見るためにデータの個々の値と平均値との差の二乗の算術平均を分散（標本分散$s^2$）、

<!-- $$s^2 = \frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})^2$$￥ -->
<!-- $$s = \sqrt{s^2} = \sqrt{\frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})^2}$$ -->
\begin{align}
  s^2 = \frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})^2 (\#eq:variance)
\end{align}

単位を戻すために分散の平方根をとったものを標準偏差（標本標準偏差$s$）と呼びます。

\begin{align}
  s = \sqrt{s^2} = \sqrt{\frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})^2} (\#eq:standatd-deviation)
\end{align}

しかし、**R**にはこの標本分散（$s^2$）を求める関数は用意されていません。代わりに不偏分散（$\hat{\sigma}^2$）を求める`var()`関数が用意されています。

<!-- $$\hat{\sigma}^2 = \frac{1}{n - 1} \sum_{i = 1}^n (x_i - \bar{x})^2 = var(x)$$ -->
\begin{align}
  \hat{\sigma}^2 &= \frac{1}{n - 1} \sum_{i = 1}^n (x_i - \bar{x})^2 (\#eq:var) \\
  &= var(x) \notag
\end{align}

式\@ref(eq:variance)\@ref(eq:var)から標本分散（$s^2$）は`var()`関数を用いると

<!-- $$s^2 = \frac{n - 1}{n}\hat{\sigma}^2$$ -->
\begin{align}
  s^2 &= \frac{n - 1}{n}\hat{\sigma}^2 (\#eq:variance-var) \\
  &= \frac{length(x) - 1}{length(x)} \times var(x) \notag
\end{align}

のように求めることができます。標本標準偏差（$s$）は式\@ref(eq:variance-var)の平方根を取ればいいこともわかります。

<!-- 母分散（$\sigma^2$）これは分からない -->

<!-- 標本分散（$s^2$） 標本から求められる -->

<!-- 母分散の不偏推定量（$\hat{\sigma}^2$）不偏標本分散・不偏分散ともいい、標本から推定する -->


### モーメント
本節の内容はデータ分析ではあまり使いませんので読み飛ばして頂いても結構です。

平均（分布の重心）と分散（分布の広がり）は、歪度（分布の左右非対称度合い）、尖度（分布の峰の尖り度合い）を含めて「モーメントから求められる要約統計量」と呼ぶことがあります。

$n$個のデータの平均値を

<!-- $$\bar{x} = \frac{1}{n}\sum_{i = 1}^{n}x_i$$ -->
\begin{align}
  \bar{x} = \frac{1}{n}\sum_{i = 1}^{n}x_i (\#eq:moment1)
\end{align}

とした場合、平均値まわりの$m$次の中央モーメント$\bar{x}_m$を

<!-- $$\bar{x}_m = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^m　　(m = 2, 3, 4)$$ -->
\begin{align}
  \bar{x}_m = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^m　　(m = 2, 3, 4) (\#eq:moment)
\end{align}

と定義します。$m = 2$の場合、

<!-- $$\bar{x}_2 = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^2 = s^2$$ -->
\begin{align}
  \bar{x}_2 = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^2 = s^2 (\#eq:moment2)
\end{align}

となりますので、$\bar{x}_2$は分散$s^2$であることがわかります。$m = 3$の場合、

<!-- $$\bar{x}_3 = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^3$$ -->
\begin{align}
  \bar{x}_3 = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^3 (\#eq:moment3)
\end{align}

となり、これを標準偏差の三乗（$s^3$）で割ったもの

<!-- $$\gamma_1 = \frac{\bar{x}_3}{s^3}$$ -->
\begin{align}
  \gamma_1 = \frac{\bar{x}_3}{s^3} (\#eq:skewness)
\end{align}

を歪度（$\gamma_1$）と呼びます。$m = 4$の場合、

<!-- $$\bar{x}_4 = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^4$$ -->
\begin{align}
  \bar{x}_4 = \frac{1}{n}\sum_{i = 1}^{n}(x_i - \bar{x})^4  (\#eq:moment4)
\end{align}

となり、これを標準偏差の四乗、または、分散の二乗（$s^4$）で割ったもの

<!-- $$\gamma_2 = \frac{\bar{x}_4}{s^4}$$ -->
\begin{align}
  \gamma_2 = \frac{\bar{x}_4}{s^4} (\#eq:kurtosise)
\end{align}

<!-- \begin{align} -->
<!--   \gamma_2 &= \frac{\bar{x}_4}{s^4} (\#eq:kurtosis) -->
<!-- \end{align} -->

を尖度（$\gamma_2$）と呼びます。

歪度や尖度を求める関数は標準では用意されていませんので**`e1071`**パッケージを用います。

```{r, eval=FALSE}
install.packages("e1071")
library(e1071)
```


#### 歪度
歪度はデータ分布の左右対象度合いです。左右対象となるデータ分布であれば$0$、右に歪んでいれば正の値を、左に歪んでいれば負の値を取ります。例えば下図のような分布では

```{r, echo=FALSE, fig.cap="正規分布に近い分布"}
set.seed(200)
x <- rnorm(10000)
hist(x, xlab = "", ylab = "", main = "", axes =FALSE)
```

歪度はゼロに近い値となります。

```{r}
e1071::skewness(x)
```

次に下図のような分布では

```{r, echo=FALSE, fig.cap="右に歪んだ分布（左に偏った分布）"}
set.seed(200)
x <- rchisq(10000, df = 5)
hist(x, xlab = "", ylab = "", main = "", axes =FALSE)
```

歪度は正の値をとります。

```{r}
e1071::skewness(x)
```

上図とは逆の分布では

```{r, echo=FALSE, fig.cap="左に歪んだ分布（右に偏った分布）"}
set.seed(200)
x <- 30 - rchisq(10000, df = 5)
hist(x, xlab = "", ylab = "", main = "", axes =FALSE)
```

歪度は負の値をとります。

```{r}
e1071::skewness(x)
```


#### 尖度
尖度はデータ分布の尖り具合です。標準正規分布と等しければ$0$、標準正規分布より尖ったt分布のような分布では正の値、広がった分布であれば負の値をとります。

```{r, echo=FALSE, fig.cap="正規分布に近い分布"}
set.seed(300)
x <- rnorm(50000)
hist(x, xlab = "", ylab = "", main = "", axes =FALSE)
```

```{r}
e1071::kurtosis(x)
```

```{r, echo=FALSE, fig.cap="中心部が高く幅の狭い尖った分布"}
set.seed(300)
x <- rt(50000, df = 10)
hist(x, xlab = "", ylab = "", main = "", axes =FALSE)
```

```{r}
e1071::kurtosis(x)
```

```{r, echo=FALSE, fig.cap="中心部が低く横に広がった分布"}
set.seed(300)
x <- rnorm(50, sd = 5)
hist(x, xlab = "", ylab = "", main = "", axes =FALSE)
```

```{r}
e1071::kurtosis(x)
```

<!-- \newpage -->


### 中央値
平均値や分散・標準偏差はデータの分布が平均値を中心に左右対象になっているような場合は有用な統計量ですが、データの分布が大きく歪んでいる対象に対しては適した統計量とは言えません。このような場合、平均値の代わりに中央値（中位数）や最頻値、分散・標準偏差に代わり範囲・分位範囲（分位値）を用いるます。これらの統計量はデータの中の位置を用いますので、データの分布に影響されることが少ないロバストネス（頑健性の高い）な統計量です。

中央値は文字通り中央（真ん中）に位置する値です。データを小さい順に並べて真ん中に位置する値で、`median()`関数を使って求めます。データが順番に並んでいなくても`median()`関数内でソート処理を行います。
```{r}
x <- c(1, 3, 5, 9, 7)
median(x)
```

データの長さ（値の数）が奇数の場合は、単純に中央の値（上記の場合は$`r sort(x)`$なので中央に位置する$`r median(x)`$）を返しますが、データの長さ偶数の場合は中央に近い両側の値の平均値（相加平均）を返します。
```{r}
x <- c(1, 3, 5, 9, 7, 6)
median(x)
```

例えば、上記のようにデータの長さが偶数（$`r length(x)`$）で$`r sort(x)`$というデータですので、中央に最も近い$`r sort(x)[((length(x) + 1L) %/% 2L) + 0L:1L]`$の平均値を中央値としています。

中央値と平均値を比較すると中央値がデータの分布に影響されにくい（ロバストネス）なことが分かります。
```{r}
x <- c(1, 3, 5, 9, 7)
y <- c(1, 3, 5, 9, 28)
```

```{r}
median(x)                    # 中央値の比較
median(y)                    # 中央値の比較（大きい値には引っ張られない）
mean(x)                      # 平均値の比較
mean(y)                      # 平均値の比較（大きい値に引っ張られている）
```


### 範囲
前述の`x`と`y`は、中央値で見る限りと同じデータになってしまいます。この結論はいささか不合理ですので、データのばらつきを範囲（レンジ）で見てみます。範囲を求めるには、その名の通りの`range()`を用います。

```{r}
x
range(x)
y
range(y)
```

範囲でみると`y`の方が`x`よりばらついていることが分かります。

`range()`関数は最小値と最大値を一度に取得しています。最小値は`min()`関数、最大値は`max()`関数で求められますので、`range()`関数は以下のように処理をしていることが分かります。

```{r}
c(min(x), max(x))
```

最小値から最大値の幅を求めたい場合には`min()`関数と`max()`関数を用いるよりは`diff()`関数を用いた方が簡単です。

```{r}
diff(range(x))
diff(range(y))
```


### 四分位数・四分位範囲
中央値は中位数と呼ばれるようにデータを二分の一にした場所にあるデータです。さらに細かくして全体を四分の一にしたの場所にあるデータを四分位数と呼びます。小さい方から見て最初の四分の一にある値を第一四分位数（$25\%$点、$Q_1$）、次の四分の一にある値を第二四分位数（$50\%$点、$Q_2$）、次の四分の一にある値を第三四分位数（$75\%$点、$Q_3$）といいます。第二四分位数（$50\%$点、$Q_2$）は中央値（中位数）とイコールです。
四分位数にも範囲があり、四分位範囲（$IQR$, interquartile range）と呼ばれ以下のように定義されます、

<!-- $$IQR = Q_3 - Q_1$$ -->
\begin{align}
  IQR = Q_3 - Q_1 (\#eq:IQR)
\end{align}

四分位数は`quantile()`関数で求めることができます。オプションの引数を指定しなければ第一〜第三四分位数に加えて最小値（$0\%点$）・最大値（$100\%点$）を加えた五つの値が返ってきます。
```{r}
quantile(x)
```

任意の四分位数を求めたい場合は引数`prob`を指定します。`prob`は$0$〜$1$の間で指定する点に中位してください。
```{r}
quantile(x, prob = 0.25)
```

複数の四分位数を同時に求めことも可能です。
```{r}
quantile(x, prob = c(0.25, 0.75))
```

四分位範囲（$IQR$）を求める場合は`IQR()`関数が便利です。
```{r}
IQR(x)
```


### 最頻値
最頻値（モード）とは文字通り、最も頻繁に出てくる値のことです。例えば、以下の`x`と`y`は、平均値・中央値・範囲は全て同じ値になるデータです。
```{r}
x <- c(1, 1, 3, 5, 9)
y <- c(1, 3, 3, 3, 9)
mean(x)
mean(y)
median(x)
median(y)
diff(range(x))
diff(range(y))
```

このようなデータに対しては最頻値を用いると平均値・中央値・範囲では見えなかった差異が見える場合があります。最頻値を求める関数は標準では用意されていませんので`modeest`パッケージを用います。
```{r, eval=FALSE}
install.packages("modeest")
library(modeest)
```

```{r}
modeest::mfv(x)
modeest::mfv(y)
```

\newpage

### まとめ
本節に出てきた要約統計量と関数は下表の通りです。

: 要約統計量のまとめ

要約統計量    | 表記             | **R**での求め方[^22]
--------------|:----------------:|-------------------------------------------
標本平均      | $\bar{x}$        | `mean(x)`
トリム平均    |                  | `mean(x, trim = t), t = 0 to 0.5`
幾何平均      |                  | `psych::geometric.mean(x)`
標本分散      | $s^2$            | `(length(x) - 1) / length(x) * var(x)`
不偏分散      | $\hat{\sigma}^2$ | `var(x)`
標本標準偏差  | $s$              | `sqrt((length(x) - 1) / length(x) * var(x))`
不偏標本偏差  | $\hat{\sigma}$   | `sd(x)`
歪度          | $\gamma_1$       | `e1071::skewness(x)`
尖度          | $\gamma_2$       | `e1071::kurtosis(x)`
中央値        |                  | `median(x)`
範囲          | $R$[^23]         | `range(x)` or `diff(range(x))`
四分位数      | $Q_n$            | `quantile(x)`
第$n$四分位数 | $Q_n$            | `quantile(x, probs = u), u = 0.25*n, n = 1, 2, 3`[^24]
四分位範囲    | $IQR$            | `IQR(x)`
最頻値        |                  | `modeest::mfv(x)`

[^22]: 引数`x`は計算対象となる数値データが格納されたベクトル型の変数
[^23]: 重相関計数を意味する場合もあり
[^24]: 引数`probs`はベクトル指定も可能（例：`probs = c(0.25, 0.75)`）

\newpage

### 演習


#### 演習 `r eqn` {.unnumbered}
標本分散（$s^2$）と不偏分散（$\hat{\sigma}^2$）の関係式\@ref(eq:variance-var)を用いて以下の二つのデータの標本分散（$s^2$）を求めなさい。

```{r}
x <- c(1, 5, 5, 5, 9)
y <- c(1, 1, 5, 9, 9)
```


```{r, include=FALSE}
eqn <- eqn + 1
```


#### 演習 `r eqn` {.unnumbered}
欠損値を含む以下のデータの平均値（$\bar{x}$）、不偏分散（$\hat{\sigma}^2$）ならびに標本分散（$s^2$）を求めなさい。

```{r}
z <- c(1, 5, NA, 7, 9)
```

> 引数`na.rm`を指定します


```{r, include=FALSE}
eqn <- eqn + 1
```


#### 演習 `r eqn` {.unnumbered}
`iris`データセットの各変量に対する四分位数を求めなさい。

\newpage

### コラム {.unnumbered}
<!-- ```{block2, type="rmdnote", include=knitr::is_latex_output()} -->
```{block2, type="rmdnote"}
**英字？ギリシャ文字？**  
　統計の書籍では様々な統計量を英字で表記する場合とギリシャ文字で表記する場合があり混乱しやすいのですが、英字（アルファベット）で表記されている場合は標本統計量、ギリシャ文字で表記されている場合は母集団の統計量もしくは母集団の推定統計量を意味しています。  
　推定統計量を表記する場合、推定であることを意味するハット（ $\hat{}$ ）という記号をつけます。平均と分散・標準偏差を使って整理すると下表のようになります。

: 統計量の表記ルール

統計量         | 平均         | 分散             | 標準偏差       | 備考
---------------|:------------:|:----------------:|:--------------:|-------------
母集団の統計量 | $\mu$        | $\sigma^2$       | $\sigma$       | 神のみぞ知る統計量
（不偏）推定量 | $\hat{\mu}$  | $\hat{\sigma}^2$ | $\hat{\sigma}$ | 標本から母集団を推定した統計量
標本統計量     | $\bar{x}$    | $s^2$            | $s$            | 標本から求める統計量


　ハット（ $\hat{}$ ）を省略している書籍や資料も散見されますので混乱しないように注意してください。詳しくは『統計的方法のしくみ』[@ToukeitekiHouhounoSikumi:jbook]の「3. 母数と統計量の区別」や『統計解析のはなし』[@ToukeiKaisekinoHanashi]の「2. 素人探偵物語」などを参照してください。
```

\newpage
